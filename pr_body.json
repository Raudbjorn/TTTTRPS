{"body":"## Summary\n\nThis PR implements the comprehensive Campaign Generation Overhaul, introducing the Campaign Intelligence Pipeline (CIP) architecture for AI-assisted campaign creation and session management.\n\n### Phase 1: Database Foundation & Pipeline Types\n- Database migrations V21-V27 for wizard states, conversations, citations, party compositions, quick reference cards, random tables, and session recaps\n- Core pipeline types: TrustLevel, CanonStatus, EntityDraft, Citation\n\n### Phase 2: Wizard State Machine  \n- 8-step wizard (Basics â†’ Intent â†’ Scope â†’ Players â†’ PartyComposition â†’ ArcStructure â†’ InitialContent â†’ Review)\n- PartialCampaign draft model with autosave and crash recovery\n- Support for both manual and AI-assisted modes\n\n### Phase 3: Content Grounding Layer\n- CitationBuilder, RulebookLinker, FlavourSearcher, UsageTracker\n- Citation-based trust classification (Canonical/Derived/Creative/Unverified)\n\n### Phase 4: Generation Orchestration\n- TemplateRegistry with YAML prompt templates\n- GenerationOrchestrator for LLM pipeline coordination\n- Specialized generators: Character, NPC, Session, Arc, Party analysis\n\n### Phase 5: Conversation Management\n- ConversationManager with thread/message persistence\n- Decision ledger for accepted/rejected/modified suggestions\n- Branch support for alternative exploration\n\n### Phase 6: Frontend Wizard Components\n- WizardShell, step components, ConversationPanel, InterviewMode\n- Leptos 0.7 reactive components with Tailwind CSS\n\n### Phase 7: Integration and Polish\n- Draft recovery, auto-save (30s intervals), LLM availability detection\n- Tooltip/help system with TTRPG terminology\n- Error display components\n\n### Phase 8: Random Tables & Session Recaps\n- DiceNotation parser (d4-d100, d66, compound notation)\n- RandomTableEngine with nested/cascading support\n- RecapGenerator with PC knowledge filtering\n- 49 unit tests\n\n### Phase 9: Quick Reference Cards & Cheat Sheets\n- Entity card rendering with 3 disclosure levels\n- CardTray (max 6 pinned cards), CheatSheetBuilder\n- HTML export for print-friendly output\n- 31 unit tests\n\n## Architecture Highlights\n\n- **Single source of truth**: PartialCampaign draft during creation\n- **AI proposes, GM decides, CampaignManager commits**\n- **Progressive commitment**: Draft â†’ Approved â†’ Canonical â†’ Deprecated\n- **Trust is explicit**: All generated content carries trust levels\n\n## Test Plan\n\n- [x] Backend compiles with only warnings\n- [x] Frontend compiles with only warnings  \n- [x] 79 database tests pass\n- [x] 21 quick_reference tests pass\n- [x] 10 cheat_sheet tests pass\n- [x] 26 dice tests pass\n- [x] 13 random_table tests pass\n- [x] 10 recap tests pass\n- [x] 15 wizard integration tests pass\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)"}
